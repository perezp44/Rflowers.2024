<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Pedro J. Pérez">
<title>Delitos en España (II): una comparativa internacional – My last blog’s (2024-9999)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../imagenes/ababol_redondeado.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/academicons-1.9.2/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/academicons-1.9.2/size.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la busqueda",
    "search-hide-matches-text": "Esconder resultados adicionales",
    "search-more-match-text": "hay más resultados en este documento",
    "search-more-matches-text": "más resultados en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../../site_libs/datatables-binding-0.33/datatables.js"></script><script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><link rel="stylesheet" href="../../assets/quarto_yaml_styles.css">
<link rel="stylesheet" href="../assets/my_css_file.css">
<meta property="og:title" content="Delitos en España (II): una comparativa internacional – My last blog’s (2024-9999)">
<meta property="og:description" content="ESte segundo post sobre incidencia delictiva en España haré una comparación de los datos de delitos en España con los de otros países usando datos de la UNDOC. En términos coloquiales pretendo intentar dar una respuesta a la pregunta: ¿es España un país seguro?">
<meta property="og:image" content="https://perezp44.github.io/Rflowers.2024/blog_Rflowers/2025-03-07_delitos-02-mundo/imagenes/thumbnail_resized.png">
<meta property="og:site_name" content="My last blog's (2024-9999)">
<meta property="og:image:height" content="426">
<meta property="og:image:width" content="640">
<meta name="twitter:title" content="Delitos en España (II): una comparativa internacional – My last blog’s (2024-9999)">
<meta name="twitter:description" content="ESte segundo post sobre incidencia delictiva en España haré una comparación de los datos de delitos en España con los de otros países usando datos de la UNDOC. En términos coloquiales pretendo intentar dar una respuesta a la pregunta: ¿es España un país seguro?">
<meta name="twitter:image" content="https://perezp44.github.io/Rflowers.2024/blog_Rflowers/2025-03-07_delitos-02-mundo/imagenes/thumbnail_resized.png">
<meta name="twitter:creator" content="@pjpv4444">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image-height" content="426">
<meta name="twitter:image-width" content="640">
</head>
<body class="floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../imagenes/ababol_redondeado.png" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">My last blog’s (2024-9999)</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Buscar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Navegación de palanca" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../../blog_Rflowers.html" target="_blank"> 
<span class="menu-text">R &amp; flowers</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog_TBits.html" target="_blank"> 
<span class="menu-text">TBits</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">Pedro J. Pérez</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/perezp44" title="" class="quarto-navigation-tool px-1" aria-label="" target="_blank"><i class="bi bi-github"></i></a>
    <a href="mailto:pedro.j.perez@uv.es" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-envelope"></i></a>
    <a href="https://fosstodon.org/@pjperez" title="Mastodon" class="quarto-navigation-tool px-1" aria-label="Mastodon" target="_blank"><i class="bi bi-mastodon"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Delitos en España (II): una comparativa internacional</h1>
            <p class="subtitle lead"></p>
<p>ESte segundo post sobre incidencia delictiva en España haré una comparación de los datos de delitos en España con los de otros países usando datos de la UNDOC. En términos coloquiales pretendo intentar dar una respuesta a la pregunta: ¿es España un país seguro?</p>
                                <div class="quarto-categories">
                <div class="quarto-category">delitos</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author column-body">
    <div class="quarto-title-meta-heading">Autor</div>
    <div class="quarto-title-meta-heading">Afiliación</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://perezp44.github.io/pjperez.web/">Pedro J. Pérez</a> <a href="https://orcid.org/0000-0001-9375-6330" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              <a href="https://www.uv.es">
              Universitat de València
              </a>
            </p>
        </div>
    </div>

  <div class="quarto-title-meta column-body">

        
      <div>
      <div class="quarto-title-meta-heading">Fecha de Publicación</div>
      <div class="quarto-title-meta-contents">
        <p class="date">7 de marzo de 2025</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Fecha de modificación</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">17 de marzo de 2025</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Índice</h2>
   
  <ul>
<li><a href="#intro" id="toc-intro" class="nav-link active" data-scroll-target="#intro"><span class="header-section-number">1</span> Intro</a></li>
  <li>
<a href="#un-vistazo-r%C3%A1pido-a-los-datos" id="toc-un-vistazo-rápido-a-los-datos" class="nav-link" data-scroll-target="#un-vistazo-r%C3%A1pido-a-los-datos"><span class="header-section-number">2</span> Un vistazo rápido a los datos</a>
  <ul class="collapse">
<li><a href="#categor%C3%ADas-de-delitos" id="toc-categorías-de-delitos" class="nav-link" data-scroll-target="#categor%C3%ADas-de-delitos">Categorías de delitos</a></li>
  <li><a href="#procesamiento-de-los-datos" id="toc-procesamiento-de-los-datos" class="nav-link" data-scroll-target="#procesamiento-de-los-datos">Procesamiento de los datos</a></li>
  <li><a href="#m%C3%A1s-procesamiento-de-los-datos" id="toc-más-procesamiento-de-los-datos" class="nav-link" data-scroll-target="#m%C3%A1s-procesamiento-de-los-datos">Más procesamiento de los datos</a></li>
  </ul>
</li>
  <li>
<a href="#algunos-resultados" id="toc-algunos-resultados" class="nav-link" data-scroll-target="#algunos-resultados"><span class="header-section-number">3</span> Algunos resultados</a>
  <ul class="collapse">
<li><a href="#coropletas" id="toc-coropletas" class="nav-link" data-scroll-target="#coropletas">Coropletas</a></li>
  <li><a href="#tablas" id="toc-tablas" class="nav-link" data-scroll-target="#tablas">Tablas</a></li>
  </ul>
</li>
  <li><a href="#referencias" id="toc-referencias" class="nav-link" data-scroll-target="#referencias">Referencias</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/perezp44/Rflowers.2024/edit/master/blog_Rflowers/2025-03-07_delitos-02-mundo/index.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta página</a></li><li><a href="https://github.com/perezp44/Rflowers.2024/issues/new" class="toc-action"><i class="bi empty"></i>Informar de un problema</a></li></ul></div></nav>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full column-body" id="quarto-document-content"><section id="intro" class="level2" data-number="1"><h2 data-number="1" class="anchored" data-anchor-id="intro">
<span class="header-section-number">1</span> Intro</h2>
<p>En este post voy a utilizar los datos de la la Oficina de las Naciones Unidas para drogas y crimen (<a href="https://www.unodc.org/">UNDOC</a>) sobre delitos para ver la situación de España en estos temas. Ya conté cómo procese estos datos en el anterior post, concretamente <a href="../2025-01-29_delitos-01-inicio/#undoc" target="_blank">aquí</a>.</p>
<p>Solo recordaré aquí que los datos de la UNDOC contienen observaciones de 212 países/regiones sobre 27 tipos de delitos para el periodo 1990-2023; aunque es evidente que solo algunos países presentan datos para todos los indicadores y periodo muestral. Lo vamos viendo poco a poco.</p>
</section><section id="un-vistazo-rápido-a-los-datos" class="level2 page-columns page-full" data-number="2"><h2 data-number="2" class="anchored" data-anchor-id="un-vistazo-rápido-a-los-datos">
<span class="header-section-number">2</span> Un vistazo rápido a los datos</h2>
<section id="categorías-de-delitos" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="categorías-de-delitos">Categorías de delitos</h3>
<p>Entre los datos que me llamaron la atención (y que voy a procesar) están las categorías:</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Me centré en 3 categorías de delitos, descargando y procesando un total de <u>27 tipos de delitos</u></p>
</div></div><ul>
<li><p><strong>Intentional Homicide</strong>: los datos están <a href="https://dataunodc.un.org/dp-intentional-homicide-victims">aquí</a>. Son datos con mucho detalle porque tiene posibilidad de filtrar por genero, edad, medio, situación etc… etc… pero me centré en un <strong>único indicador</strong> sin tener en cuenta los “detalles”: “Victims of intentional homicide”</p></li>
<li><p><strong>Violent &amp; Sexual Crime</strong>: los datos están <a href="https://dataunodc.un.org/dp-crime-violent-offences">aquí</a>. Contienen también mucho detalle, pero me centré en procesar <u>10 indicadores</u>: Serious assault, Kidnapping, Sexual violence, Sexual violence: Rape, Sexual violence: Sexual assault, Sexual violence: Other acts of sexual violence, Sexual Exploitation, Acts intended to induce fear or emotional distress y Acts intended to induce fear or emotional distress: Cyber-related</p></li>
<li><p><strong>Corruption &amp; Economic Crime</strong>: los datos están <a href="https://dataunodc.un.org/dp-crime-corruption-offences">aquí</a>. Contienen <u>16 indicadores</u>: Corruption, Corruption: Bribery, Corruption: Other acts of corruption, Smuggling of migrants, Burglary, Theft, Theft: of a motorized vehicle, Fraud, Fraud: Cyber-related (Cy), Money laundering, Unlawful access to a computer system, Unlawful interference with a computer system or computer data, Acts that cause environmental pollution or degradation, Acts involving the movement of dumping of waste, Trade or possession of protected or prohibited species of faune and flora, Acts that result in the depletion of degradation of natural resources</p></li>
</ul>
<p>Además, no los voy a procesar, pero también me llamó la atención la categoría:</p>
<ul>
<li>
<strong>Prisons &amp; Prisoners</strong>: los datos están <a href="https://dataunodc.un.org/dp-prisons-persons-held">aquí</a>. Contiene datos sobre personas en la carcel por Intentional Homicide, Rape, Drug trafficking y Bribery; además diferencia entre personas con y sin sentencia, etc … etc …</li>
</ul>
<p><br></p>
</section><section id="procesamiento-de-los-datos" class="level3"><h3 class="anchored" data-anchor-id="procesamiento-de-los-datos">Procesamiento de los datos</h3>
<p>Los datos los descargué en febrero de 2025 y los procesé con el script <code>/my_mungings.2024a/blog_01_INE/007_UNDOC_crimenes/02_fusionar-y-exportar-datos_UNdoc.R</code>. Allí generé 2 conjuntos de datos que posteriormente alojé en mi paquete de datos <code>pjpv.pkg.datos.2024</code>; concretamente son los ficheros:</p>
<ol type="1">
<li><p><code>delitos_UNDOC_tipologia_delitos_2023</code>: contiene datos de 1990 a 2023 de 212 países (o regiones) sobre 27 tipos de delitos. Es el conjunto de datos que voy a usar en el post</p></li>
<li><p><code>delitos_UNDOC_tipologia_delitos_2023_relacion</code>; contiene datos de 2013 a 2022 de 49 países sobre 2 tipos de delitos: Victims of serious assault y Victims of sexual violence. En este data.frame que mantuve la información sobre la relación de la victima con el perpretador del delito, pero finalmente no voy a usar estos datos</p></li>
</ol>
<p>En este post solo voy a usar los datos del primer dataset. Los 27 tipos de delitos que contiene son:</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>zz <span class="ot">&lt;-</span> pjpv.pkg.datos<span class="fl">.2024</span><span class="sc">::</span>delitos_UNDOC_tipologia_delitos_2023 <span class="sc">|&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(indicator, category)</span>
<span id="cb1-3"><a href="#cb1-3"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(zz)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-f0bfc08308a56544df8d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f0bfc08308a56544df8d">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27"],["Violent offences","Violent offences","Violent offences","Violent offences","Violent offences","Violent offences","Violent offences","Violent offences","Violent offences","Victims of intentional homicide","Offences","Offences","Offences","Offences","Offences","Offences","Offences","Offences","Offences","Offences","Offences","Offences","Offences","Acts against the environment","Acts against the environment","Acts against the environment","Acts against the environment"],["Serious assault","Kidnapping","Sexual violence","Sexual violence: Rape","Sexual violence: Sexual assault","Sexual violence: Other acts of sexual violence","Sexual Exploitation","Acts intended to induce fear or emotional distress","Acts intended to induce fear or emotional distress: Cyber-related","Victims of intentional homicide","Corruption","Corruption: Bribery","Corruption: Other acts of corruption","Smuggling of migrants","Burglary","Theft","Theft: of a motorized vehicle","Fraud","Fraud: Cyber-related (Cy)","Money laundering","Unlawful access to a computer system","Unlawful interference with a computer system or computer data","Unlawful interception or access of computer data","Acts that cause environmental pollution or degradation","Acts involving the movement of dumping of waste","Trade or possession of protected or prohibited species of faune and flora","Acts that result in the depletion of degradation of natural resources"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>indicator<\/th>\n      <th>category<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"indicator","targets":1},{"name":"category","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section><section id="más-procesamiento-de-los-datos" class="level3"><h3 class="anchored" data-anchor-id="más-procesamiento-de-los-datos">Más procesamiento de los datos</h3>
<p>Como he dicho más arriba, los datos que descargué de la UNDOC los procesé<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> en mi blog local “<code>my_mungins</code>” y los 2 data.frames resultantes los alojé en mi paquete de datos.</p>
<p>Después de procesar los datos me di cuenta que solo iba a usar el dataset <code>delitos_UNDOC_tipologia_delitos_2023</code> que como he dicho, contiene datos de 1990 a 2023 de 212 países (o regiones) sobre 27 tipos de delitos. También me di cuenta que iba a necesitar geometrías de esos 212 países/regiones para poder hacer coropletas.</p>
<section id="geometrías" class="level4"><h4 class="anchored" data-anchor-id="geometrías">geometrías</h4>
<p>Para obtener geometrías utilice el paquete <a href="https://ropengov.github.io/giscoR/">giscoR</a> que facilita usar en R los datos de GISCO, the Geographic Information System de la Commisión Europea. Concretamente utilice este dataset que contiene 259 geometrías</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>world <span class="ot">&lt;-</span> giscoR<span class="sc">::</span><span class="fu">gisco_get_countries</span>(<span class="at">year =</span> <span class="dv">2024</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="fu">select</span>(ISO3_CODE, CNTR_ID, NAME_ENGL, CAPT, SVRG_UN, EU_STAT, geometry)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#- fusiono con crimenes</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>world_crime <span class="ot">&lt;-</span> <span class="fu">left_join</span>(df, world, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"iso3_code"</span> <span class="ot">=</span> <span class="st">"ISO3_CODE"</span>)) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>He de recordar que en los datos que voy a usar de UNDOC habían 212 países/territorios. Cuando fusioné estos datos con las geometrías de GISCO, se obtuvieron las geometrías de 200 de ellos, pero quedaron sin fusionar 12 entidades territoriales. Habían 4 tipos de problemas:</p>
<ol type="1">
<li>Los datos de UNDOC para el Reino Unido estaban separados en 3 entidades (Escocia, Irlanda del Norte y el resto; es decir, Inglaterra y Gales). Deje esos datos tal cual, pero a partir de ellos generé los datos para todo el Reino Unido. La geometría del Reino Unido sí se encontraba en GISCO, pero para obtener las geometrías de las 3 entidades territoriales originales para UK tuve que usar otro dataset de GISCO, concretamente:</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>UK_geo_3 <span class="ot">&lt;-</span> giscoR<span class="sc">::</span>gisco_nuts <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">filter</span>(LEVL_CODE <span class="sc">==</span> <span class="dv">1</span>)  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(CNTR_CODE <span class="sc">==</span> <span class="st">"UK"</span>) <span class="co">#- 12 geometrías para UK</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="2" type="1">
<li>Los datos de UNDOC para Francia hacían referencia a Francia, pero también, para algunos delitos, a los territorios de ultramar franceses. En concreto hay datos para los siguientes territorios <code>"France", "Guadeloupe",  "French Guiana", "Martinique", "Réunion", "Mayotte", "Saint Martin (French Part)"</code>. Deje todos los datos tal cual, pero claro al intentar fusionar con las geometrías de GISCO, solo se fusionaba con <code>"France"</code>. Para encontrar geometrías para el resto de entidades francesas (los territorios de ultramar) tuve que usar otro dataset de GISCO, consiguiendo enlazar todas las entidades territoriales francesas excepto <code>"Saint Martin (French Part)"</code>. El dataset que usé fue:</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>fra_ultramar <span class="ot">&lt;-</span> giscoR<span class="sc">::</span><span class="fu">gisco_nuts</span>() <span class="sc">%&gt;%</span> <span class="fu">filter</span>(LEVL_CODE <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="fu">filter</span>(CNTR_CODE <span class="sc">==</span> <span class="st">"FR"</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="fu">filter</span>(NUTS_ID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"FRY1"</span>, <span class="st">"FRY2"</span>,<span class="st">"FRY3"</span>,<span class="st">"FRY4"</span>,<span class="st">"FRY5"</span>)) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="3" type="1">
<li><p>En los datos de delitos de la UNDOC hay datos referentes a Kosovo ( “Kosovo under UNSCR 1244”), con datos para algunos tipos de delitos para el periodo de 2008 a 2021. Deje estos datos tal cual, pero no encontré su geometría en GISCO. Finalmente encontré geometría para Kosovo en otro dataset (no de GISCO) pero decidí no incorporarla al análisis; es decir, los datos de Kosovo si estarán en el análisis pero no se mostrarán en las coropletas que vaya haciendo.</p></li>
<li><p>En el caso de Irak, los datos de delitos de la UNDOC, tienen 3 entidades territoriales: <code>"Iraq", "Iraq (Kurdistan Region)" e "Iraq (Central Iraq)"</code>. Decidí quitar las observaciones, no eran muchas, de <code>"Iraq (Kurdistan Region)" e "Iraq (Central Iraq)"</code>, dejando sólo las de “Iraq”. Estas observaciones lógicamente se fusionaron con la geometría de Irak obtenida de GISCO.</p></li>
</ol>
<p><br></p>
<p>Todo este trabajo de procesado de datos lo lleve a cabo con el script <code>01_anyadir-geometrias_y_exportar-datos_UNdoc.R</code>. Los datos finales que voy a usar en el análisis los exporte al fichero <code>datos_crim_blog_2025.Rdata</code> que contiene dos ficheros:</p>
<ol type="1">
<li><p><code>df_crimenes_ok</code>: contiene los datos de UNDOC originales, pero yo añadí los datos para el global de United Kingdom</p></li>
<li><p><code>geometrias_ok</code>: contiene las geometrías de GISCO (contiene también ñlas 3 entidades para UK y los territorios de ultramar franceses)</p></li>
</ol>
<p><br></p>
</section></section></section><section id="algunos-resultados" class="level2" data-number="3"><h2 data-number="3" class="anchored" data-anchor-id="algunos-resultados">
<span class="header-section-number">3</span> Algunos resultados</h2>
<p>Voy a utilizar el dataset <code>delitos_UNDOC_tipologia_delitos_2023</code> que como dije, contiene datos de 27 tipos de delitos para un conjunto de 212 países. Es demasiado grande para poder mostrarlo todo, así que supongo que haré un <a href="https://shiny.posit.co/">shiny</a> y aquí solo mostraré algunos resultados para ver cómo está España.</p>
<section id="coropletas" class="level3"><h3 class="anchored" data-anchor-id="coropletas">Coropletas</h3>
<p>Voy a empezar con el delito más grave: “Victims of intentional homicide”. OK, solo un indicador, pero … ¿qué año muestro? hay datos para el periodo 1990-2023, pero en 2023 solo hay 49 países con datos; mientras que para 2022 hay 101^[El año que más países tienen datos es 2008 con 165.</p>
</section><section id="tablas" class="level3"><h3 class="anchored" data-anchor-id="tablas">Tablas</h3>
</section></section><section id="referencias" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="referencias">Referencias</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-2024wlel" class="csl-entry" role="listitem">
<span>«Banco <span>Mundial</span>»</span>. 2024. <em>Wikipedia, la enciclopedia libre</em>. <a href="https://es.wikipedia.org/w/index.php?title=Banco_Mundial&amp;oldid=164322887">https://es.wikipedia.org/w/index.php?title=Banco_Mundial&amp;oldid=164322887</a>.
</div>
<div id="ref-nasi_crime_2021" class="csl-entry" role="listitem">
Näsi, Matti, Maiju Tanskanen, Janne Kivivuori, Paula Haara, y Esa Reunanen. 2021. <span>«Crime <span>News</span> <span>Consumption</span> and <span>Fear</span> of <span>Violence</span>: <span>The</span> <span>Role</span> of <span>Traditional</span> <span>Media</span>, <span>Social</span> <span>Media</span>, and <span>Alternative</span> <span>Information</span> <span>Sources</span>»</span>. <em>Crime &amp; Delinquency</em> 67 (4): 574-600. <a href="https://doi.org/10.1177/0011128720922539">https://doi.org/10.1177/0011128720922539</a>.
</div>
</div>


</section><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Notas</h2>
<ol>
<li id="fn1"><p>En realidad los datos tuvieron poco procesamiento, solo tuve que quitar y homogeneizar cositas y tener cuidado porque, en mi opinión los datos en este caso era “demasiado largos” y estaban como preparados para contener información de edad, genero, relación con el delincuente, etc… que a mi no me hacía falta<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reutilizar</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/deed.es">CC BY 4.0</a></div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/perezp44\.github\.io\/Rflowers\.2024\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2024 Pedro J. Pérez ∙ <a class="link-dark me-1" href="https://fosstodon.org/@pjperez" title="mastodon" target="_blank" rel="noopener"><i class="fa-brands fa-mastodon" aria-label="mastodon"></i></a> ∙ <a class="link-dark me-1" href="https://github.com/perezp44" title="github" target="_blank" rel="noopener"><i class="fa-brands fa-github" aria-label="github"></i></a> ∙ <a class="link-dark me-1" href="https://orcid.org/0000-0001-9375-6330" title="orcid" target="_blank" rel="noopener"><i class="ai  ai-orcid"></i></a> ∙ <a class="link-dark me-1" href="https://scholar.google.com/citations?user=PXaWcW4AAAAJ&amp;hl=en" title="Google Scholar" target="_blank" rel="noopener"><i class="ai  ai-google-scholar"></i></a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/perezp44/Rflowers.2024/edit/master/blog_Rflowers/2025-03-07_delitos-02-mundo/index.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta página</a></li><li><a href="https://github.com/perezp44/Rflowers.2024/issues/new" class="toc-action"><i class="bi empty"></i>Informar de un problema</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="../../license.html">
<p>Licencia</p>
</a>
  </li>  
</ul>
</div>
  </div>
</footer>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>